/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2014-2015 SAP SE. All rights reserved
 */
sap.ui.define([],function(){"use strict";var A=function(){};A.getBusinessContexts=function(s,e,E){var S=this._parseServiceName(s);var a=this._parseServiceVersion(s,S);var b=this._buildBusinessContextRetrievalUri(S,a,e,E);var m=this._getAjaxSettings();var p=this._executeAjaxCall(b,m,S,a,e,E);return p;};A._parseServiceName=function(s){var S=s.lastIndexOf("/")+1;var a=s.substring(S);var b;if(a.indexOf(";v=")!=-1){b=a.substring(0,a.indexOf(";v="));}else{b=a;}return b;};A._parseServiceVersion=function(s,S){if(s.indexOf(S+";v=")!=-1){var p=s.indexOf(S+";v=");var r=s.substring(p);var P=S.length+3;var v=r.slice(P,r.indexOf("/"));return v;}else{return"0001";}};A._buildBusinessContextRetrievalUri=function(s,S,e,E){if(e==null){e='';}if(E==null){E='';}if(((E.length==0)&&(e.length==0))||(!(E.length==0)&&!(e.length==0))){throw new Error("sap.ui.fl.fieldExt.Access._buildBusinessContextRetrievalUri()"+"Inconsistent input parameters EntityName: "+e+" EntitySet: "+E);}var b="/sap/opu/odata/SAP/APS_CUSTOM_FIELD_MAINTENANCE_SRV/GetBusinessContextsByEntityType?"+"EntitySetName=\'"+E+"\'"+"&EntityTypeName=\'"+e+"\'"+"&ServiceName=\'"+s+"\'"+"&ServiceVersion=\'"+S+"\'"+"&$format=json";return b;};A._executeAjaxCall=function(b,r,s,S,e,E){var t=this;var d=jQuery.Deferred();jQuery.ajax(b,r).done(function(a,c,j){var B=[];if(a){var B=t._extractBusinessContexts(a);}var R={BusinessContexts:B,ServiceName:s,ServiceVersion:S};d.resolve(R);}).fail(function(j,a,c){var f=t._getMessagesFromXHR(j);var o={errorOccured:true,errorMessages:f,serviceName:s,serviceVersion:S,entityType:e,entitySet:E};d.reject(o);});return d.promise();};A._getAjaxSettings=function(){var s={type:"GET",async:true,dataType:'json'};return s;};A._extractBusinessContexts=function(d){var r=null;var b=[];if(d&&d.d){r=d.d.results;}if(r!==null&&r.length>0){for(var i=0;i<r.length;i++){if(r[i].BusinessContext!==null){b.push(r[i].BusinessContext);}}}return b;};A._getMessagesFromXHR=function(x){var m=[];try{var E=JSON.parse(x.responseText);if(E&&E.error&&E.error.message&&E.error.message.value&&E.error.message.value!==''){m.push({severity:"error",text:E.error.message.value});}else{m.push({severity:"error",text:x.responseText});}}catch(e){}return m;};return A;},true);
