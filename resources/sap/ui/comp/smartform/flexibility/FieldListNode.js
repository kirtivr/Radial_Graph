/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2015 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/m/CheckBox','sap/m/FlexBox','sap/m/FlexJustifyContent','sap/ui/comp/library','./Input','sap/ui/core/Control'],function(q,C,F,a,l,I,b){"use strict";var c=b.extend("sap.ui.comp.smartform.flexibility.FieldListNode",{metadata:{library:"sap.ui.comp",properties:{label:{type:"string",group:"Misc",defaultValue:null},isVisible:{type:"boolean",group:"Misc",defaultValue:null},isSelected:{type:"boolean",group:"Misc",defaultValue:null}},aggregations:{nodes:{type:"sap.ui.comp.smartform.flexibility.FieldListNode",multiple:true,singularName:"node"},layout:{type:"sap.ui.core.Control",multiple:false}},events:{selected:{parameters:{target:{type:"sap.ui.comp.smartform.flexibility.FieldListNode"}}}}}});c.prototype.init=function(){this._textResources=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this._oLayout=new F({justifyContent:a.FlexStart});this._oIsVisibleCheckbox=new C(this.getId()+'-CheckBox');this._oIsVisibleCheckbox.setTooltip(this._textResources.getText("FORM_PERS_VIS_CHECKBOX_TOOLTIP"));this._oIsVisibleCheckbox.setSelected(this.getIsVisible());this._oIsVisibleCheckbox.attachSelect(this._onCheckboxChanged.bind(this));this._oIsVisibleCheckbox.setLayoutData(new sap.m.FlexItemData({order:1}));this._oLayout.addItem(this._oIsVisibleCheckbox);this._oLabelInputField=new I(this.getId()+'-Input');this._oLabelInputField.addStyleClass("sapUiCompFieldListNodeLabelInputField");this._oLabelInputField.setValue(this.getLabel());this._oLabelInputField.setEditable(false);this._oLabelInputField.attachChange(this._onLabelChanged.bind(this));this._oLabelInputField.attachSelectedByKeyboard(this._onLabelSelectedByKeyboard.bind(this));this._oLabelInputField.setLayoutData(new sap.m.FlexItemData({order:2}));this._oLayout.addItem(this._oLabelInputField);this.setLayout(this._oLayout);};c.prototype.setLabel=function(L){this._oLabelInputField.setValue(L);this.setProperty("label",L);};c.prototype.setIsVisible=function(i){this._oIsVisibleCheckbox.setSelected(i);this.setProperty("isVisible",i);};c.prototype.setIsSelected=function(i){if(!i){this._oLabelInputField.setEditable(false);}this.setProperty("isSelected",i);};c.prototype._onCheckboxChanged=function(e){var i;i=this._oIsVisibleCheckbox.getSelected();if(i!==this.getIsVisible()){this.setProperty("isVisible",i);}};c.prototype._onLabelChanged=function(e){var L;L=this._oLabelInputField.getValue();if(L!==this.getLabel()){this.setProperty("label",L);}this._oLabelInputField.setEditable(false);};c.prototype._onLabelSelectedByKeyboard=function(e){this._oLabelInputField.setEditable(true);this._fireSelectedAndDelegateToParent(this);};c.prototype.onAfterRendering=function(){this.registerToDOMEvents();};c.prototype.onBeforeRendering=function(){this.deregisterToDOMEvents();};c.prototype.registerToDOMEvents=function(){q("#"+this.getId()).on('click',q.proxy(this._handleClick,this));};c.prototype.deregisterToDOMEvents=function(){q("#"+this.getId()).off('click');};c.prototype._handleClick=function(e){var t,s;t=e.target||e.srcElement;if(t){s=sap.ui.getCore().byId(t.id);if(!(s instanceof c)){if(t.parentElement){s=sap.ui.getCore().byId(t.parentElement.id);}}}if((s===this._oLabelInputField)&&this.getIsSelected()){this._oLabelInputField.setEditable(true);}if(s===this||s===this._oLabelInputField){this._fireSelectedAndDelegateToParent(this);}};c.prototype._fireSelectedAndDelegateToParent=function(f){var p;if(!(f instanceof c)){return;}this.fireSelected({target:f});p=this.getParent();if(p&&p instanceof c){p._fireSelectedAndDelegateToParent(f);}};return c;},true);
