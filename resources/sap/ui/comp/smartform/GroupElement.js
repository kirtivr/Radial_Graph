/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2015 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/m/Label','sap/ui/comp/library','sap/ui/core/Control','sap/ui/fl/registry/ChangeRegistry','sap/ui/fl/registry/SimpleChanges'],function(q,L,l,C,a,S){"use strict";var G=C.extend("sap.ui.comp.smartform.GroupElement",{metadata:{library:"sap.ui.comp",properties:{label:{type:"string",group:"Misc",defaultValue:null},elementForLabel:{type:"int",group:"Misc",defaultValue:0}},defaultAggregation:"elements",aggregations:{elements:{type:"sap.ui.core.Control",multiple:true,singularName:"element"}}}});G.prototype.init=function(){if(!G._bHasRegisteredToFlexibilityServices){var c=a.getInstance();c.registerControlForSimpleChange(this.getMetadata().getElementName(),S.renameField);c.registerControlForSimpleChange(this.getMetadata().getElementName(),S.hideControl);c.registerControlForSimpleChange(this.getMetadata().getElementName(),S.unhideControl);G._bHasRegisteredToFlexibilityServices=true;}this.oFormElement=new sap.ui.layout.form.FormElement();this._oView=null;this._sViewBindingPath="";this._bLayoutApplied=false;this._sLabelBindingPath="";this._sEditMode=false;this._oLabel=null;};G._bHasRegisteredToFlexibilityServices=false;G.prototype.updateLabelOfFormElement=function(){var f=this.oFormElement.getFields();var i=this.getElementForLabel();if(!this._oLabel){if(f.length>i&&f[i].getMetadata().getName()==="sap.ui.comp.smartfield.SmartField"){if(f[i].getShowLabel()){if(this.getLabel()){f[i].setTextLabel(this.getLabel());}this._oLabel=new sap.ui.comp.smartfield.SmartLabel();this._oLabel.setLabelFor(f[i]);}}else{this._oLabel=new L();if(this.getLabel()){this._oLabel.setText(this.getLabel());}}}else if(this.getLabel()){if(f.length>i&&f[i].getMetadata().getName()==="sap.ui.comp.smartfield.SmartField"){f[i].setTextLabel(this.getLabel());this._oLabel=new sap.ui.comp.smartfield.SmartLabel();this._oLabel.setLabelFor(f[i]);}else{this._oLabel.setText(this.getLabel());}}if(this._oLabel){this.oFormElement.setLabel(this._oLabel);}};G.prototype.setEditMode=function(e){this._bEditMode=e;var E=this.getElements();var i=[];E.forEach(function(o){if(o.getMetadata().getName()==="sap.m.VBox"){i=o.getItems();i.forEach(function(I){if(I.getMetadata().getName()==="sap.ui.comp.smartfield.SmartField"){if(!(I.data("editable")===false)){I.setEditable(e);}}});}else if(o.getMetadata().getName()==="sap.ui.comp.smartfield.SmartField"){if(!(o.data("editable")===false)){o.setEditable(e);}}});return this;};G.prototype._updateFormElementVisibility=function(){if(this.getVisible()===false){return;}var f=this.oFormElement.getFields();var v=f.some(function(F){return F.getVisible();});if(this.oFormElement.getVisible()!=v){this.oFormElement.setVisible(v);}};G.prototype.getLabelText=function(){if(this._oLabel){if(this._oLabel.getText){return this._oLabel.getText();}}};G.prototype.getLabel=function(){var s=this.getProperty("label");if(!s&&this._oLabel){s=this._oLabel.getText();}return s;};G.prototype.onAfterRendering=function(){this._bLayoutApplied=false;};G.prototype.onBeforeRendering=function(){var f=this.oFormElement.getFields();if(this.getParent().getParent().getProperty("useHorizontalLayout")&&!this._bLayoutApplied){this._bLayoutApplied=true;this.oFormElement.removeAllFields();this.oFormElement.addField(new sap.m.VBox({"items":[this._oLabel].concat(f)}));}};G.prototype.setProperty=function(p,v){var r;r=C.prototype.setProperty.apply(this,arguments);if(p==='label'){this.updateLabelOfFormElement();}if(p==='visible'){this.oFormElement.setVisible(v);this._updateFormElementVisibility();}return r;};G.prototype.getFormElement=function(){return this.oFormElement;};G.prototype.addElement=function(e){var t=this;if(e.getEditable){if(!e.getEditable()){e.data("editable",false);}}if(e.attachVisibleChanged){e.attachVisibleChanged(function(E){t._updateFormElementVisibility();});}this.oFormElement.addField(e);this.updateLabelOfFormElement();};G.prototype.addCustomData=function(c){C.prototype.addCustomData.apply(this,arguments);var e=this.getFormElement().getFields();e.forEach(function(E){if(E.getMetadata().getName()==="sap.ui.comp.smartfield.SmartField"){if(c.getKey()==="defaultDropDownDisplayBehaviour"){var o=E.getConfiguration();if(!o){o=new sap.ui.comp.smartfield.Configuration();E.setConfiguration(o);}if(o.getDisplayBehaviour()==="auto"){o.setDisplayBehaviour(c.getValue());}}E.addCustomData(c.clone());}});return this;};G.prototype.getAggregation=function(A){if(A==='elements'){return this.getElements();}return C.prototype.getAggregation.apply(this,arguments);};G.prototype.insertElement=function(e,i){this.oFormElement.insertField.apply(this.oFormElement,arguments);return this;};G.prototype.removeElement=function(e){return this.oFormElement.removeField.apply(this.oFormElement,arguments);};G.prototype.removeAllElements=function(){return this.oFormElement.removeAllFields.apply(this.oFormElement,arguments);};G.prototype.getElements=function(){return this.oFormElement.getFields();};G.prototype.destroyElements=function(){this.oFormElement.destroyFields();return this;};G.prototype.indexOfElement=function(e){return this.oFormElement.indexOfField(e);};return G;},true);
